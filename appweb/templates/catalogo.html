<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cat치logo de Turnos - Nails Studio</title>
   <link rel="stylesheet" href="{{ url_for('static', filename='catalogo.css') }}">
</head>
<body>

  <header>
    <h1>Agenda Nails - Cat치logo de Turnos</h1>
  <button class="volver-inicio" onclick="window.location.href='/'">Volver al inicio</button>
  </header>

  <!-- Bot칩n para entrar al modo administrador -->
  <div class="admin-access">
    <button id="btn-admin">Modo Administrador</button>
  </div>

  <!-- Secci칩n visible para el usuario -->
  <section id="usuario">
    <!-- Cat치logo de servicios -->
    <div class="catalogo">
      <!-- 12 servicios sin im치genes -->
      <div class="card" data-nombre="Esmaltado Semipermanente" data-precio="10000">
        <h3>Esmaltado Semipermanente</h3>
        <p>Tecnica que conciste en aplicar un gel o esmalte especial sobre la u침a natural y secado con luz Led o UV. Deja un acabado brillante y duradero por 21 dias.</p>
        <p>Duraci칩n 1 hora</p>
        <span class="precio">$10.000</span>
        <button class="btn-agregar">Agregar</button>
      </div>

      <div class="card" data-nombre="Soft Gel" data-precio="18000">
        <h3>Soft Gel</h3>
        <p>El sisitema de Soft Gel consiste en aplicar u침as de gel preformadas que se adieren con gel y luz led, logrando extensiones duraderas y de aspecto natural.</p>
        <p>Duraci칩n 1 hora y 30 minutos</p>
        <span class="precio">$18.000</span>
        <button class="btn-agregar">Agregar</button>
      </div>

      <div class="card" data-nombre="Capping" data-precio="15000">
        <h3>Capping</h3>
        <p>El capping consiste en proteger la u침a natural aplicado una capa de gel o acrilico sobre ella sin alargarla. Aporta brillo, dureza y mayor duracion al esmaltado.</p>
        <p>Duraci칩n 1 hora</p>
        <span class="precio">$15.000</span>
        <button class="btn-agregar">Agregar</button>
      </div>

      <div class="card" data-nombre="Sistema Polygel" data-precio="20000">
        <h3>Sistema Polygel</h3>
        <p>El sistema Polygel combina acrilico y gel, logrando una textura resistente. Se usa para esculpir o alagar u침as, ofreciendo un acabado natural y duradero.</p>
        <p>Duraci칩n 2 horas</p>
        <span class="precio">$20.000</span>
        <button class="btn-agregar">Agregar</button>
      </div>

    <!-- Carrito -->
    <aside class="carrito">
      <h2>Tu selecci칩n</h2>
      <ul id="lista-carrito"></ul>
      <p id="total">Total: $0</p>

      <input type="text" id="nombre" placeholder="Tu nombre completo">
      <input type="date" id="fecha">
      <select id="horario">
        <option value="">Selecciona horario</option>
      </select>

      <button id="btn-agendar">Agendar turno</button>
        <div class="turno">
    <div class="button-container">
      <a href="cancelar.html" class="btn cancel">Cancelar turno</a>
    </div>
  </div>
    </aside>
  </section>


  <!-- Modal -->
  <div id="modal" class="modal oculto">
    <div class="modal-contenido">
      <h3>춰Turno agendado con 칠xito!</h3>
      <p>Gracias por elegirnos 游눈</p>
    </div>
  </div>

  <!-- Panel del administrador -->
  <section id="admin" class="oculto">
    <button class="cerrar-admin">Cerrar panel</button>
    <h2>Panel del Administrador</h2>

    <!-- Form para cargar horarios -->
    <form class="admin-form" id="form-horario">
      <h3>Agregar horario disponible:</h3>
      <input type="time" id="nuevo-horario" required>
      <button type="submit" id="btn-agregar-horario">Agregar horario</button>
      <ul id="lista-horarios"></ul>
    </form>

    <!-- Tabla de turnos -->
    <h3>Turnos agendados:</h3>
    <table>
      <thead>
        <tr>
          <th>Cliente</th>
          <th>Servicios</th>
          <th>Fecha</th>
          <th>Horario</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody id="tabla-turnos"></tbody>
    </table>
  </section>

  <script>
    // --- Variables principales ---
    const botonesAgregar = document.querySelectorAll('.btn-agregar');
    const listaCarrito = document.getElementById('lista-carrito');
    const totalElemento = document.getElementById('total');
    const btnAgendar = document.getElementById('btn-agendar');
    const modal = document.getElementById('modal');
    const fechaInput = document.getElementById('fecha');
    const horarioSelect = document.getElementById('horario');
    const adminPanel = document.getElementById('admin');
    const btnAdmin = document.getElementById('btn-admin');
    const cerrarAdmin = document.querySelector('.cerrar-admin');
    const tablaTurnos = document.getElementById('tabla-turnos');
    const formHorario = document.getElementById('form-horario');
    const listaHorarios = document.getElementById('lista-horarios');
    const nuevoHorario = document.getElementById('nuevo-horario');

    let carrito = [];
    let horariosDisponibles = [];
    let turnosAgendados = [];

    // --- Deshabilitar fechas anteriores ---
    const hoy = new Date().toISOString().split('T')[0];
    fechaInput.setAttribute('min', hoy);

    // --- Agregar servicio al carrito ---
    botonesAgregar.forEach(btn => {
      btn.addEventListener('click', () => {
        const card = btn.closest('.card');
        const nombre = card.dataset.nombre;
        const precio = parseFloat(card.dataset.precio);
        carrito.push({ nombre, precio });
        actualizarCarrito();
      });
    });

    function actualizarCarrito() {
      listaCarrito.innerHTML = '';
      let total = 0;
      carrito.forEach(item => {
        const li = document.createElement('li');
        li.textContent = `${item.nombre} - $${item.precio}`;
        listaCarrito.appendChild(li);
        total += item.precio;
      });
      totalElemento.textContent = `Total: $${total}`;
    }

    // --- Agendar turno ---
    btnAgendar.addEventListener('click', () => {
      const nombre = document.getElementById('nombre').value.trim();
      const fecha = fechaInput.value;
      const horario = horarioSelect.value;
      if (!nombre || !fecha || !horario || carrito.length === 0) {
        alert('Completa todos los campos antes de agendar.');
        return;
      }
      const total = carrito.reduce((s, i) => s + i.precio, 0);
      const servicios = carrito.map(i => i.nombre).join(', ');
      const turno = { nombre, servicios, fecha, horario, total };
      turnosAgendados.push(turno);
      agregarTurnoATabla(turno);
      carrito = [];
      actualizarCarrito();
      modal.classList.remove('oculto');
      setTimeout(() => modal.classList.add('oculto'), 2500);
    });

    function agregarTurnoATabla(turno) {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td data-label="Cliente">${turno.nombre}</td>
        <td data-label="Servicios">${turno.servicios}</td>
        <td data-label="Fecha">${turno.fecha}</td>
        <td data-label="Horario">${turno.horario}</td>
        <td data-label="Total">$${turno.total}</td>
      `;
      tablaTurnos.appendChild(tr);
    }

    // --- Acceso administrador con contrase침a ---
    btnAdmin.addEventListener('click', () => {
      const pass = prompt("Ingrese la contrase침a de administrador:");
      if (pass === "admin123") {
        adminPanel.classList.remove('oculto');
        window.scrollTo({ top: adminPanel.offsetTop, behavior: 'smooth' });
      } else if (pass !== null) {
        alert("Contrase침a incorrecta.");
      }
    });

    cerrarAdmin.addEventListener('click', () => {
      adminPanel.classList.add('oculto');
    });

    // --- Administraci칩n de horarios ---
    formHorario.addEventListener('submit', e => {
      e.preventDefault();
      const hora = nuevoHorario.value;
      if (hora && !horariosDisponibles.includes(hora)) {
        horariosDisponibles.push(hora);
        actualizarHorarios();
        nuevoHorario.value = '';
      }
    });

    function actualizarHorarios() {
      listaHorarios.innerHTML = '';
      horarioSelect.innerHTML = '<option value="">Selecciona horario</option>';
      horariosDisponibles.forEach(hora => {
        const li = document.createElement('li');
        li.textContent = hora;
        listaHorarios.appendChild(li);

        const opt = document.createElement('option');
        opt.value = hora;
        opt.textContent = hora;
        horarioSelect.appendChild(opt);
      });
    }
    
  // Cuando confirmes/agendes un turno, guarda los datos en localStorage
  function guardarTurno(servicio, fecha, hora) {
    const turnos = JSON.parse(localStorage.getItem('turnos')) || [];
    turnos.push({ servicio, fecha, hora });
    localStorage.setItem('turnos', JSON.stringify(turnos));
    alert("Turno agendado correctamente");
  }
  </script>
</body>
</html>
